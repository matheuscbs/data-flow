Iniciando teste de fluxo de dados - Seg 24 Jun 2024 10:41:58 -03
Consumindo mensagens do t√≥pico Kafka 'spark-etl-topic' com kafka-console-consumer...
Mensagens recebidas do Kafka:
{"id": 1, "name": "Alice", "age": 30}
{"id": 2, "name": "Bob", "age": 25}
{"id": 3, "name": "Charlie", "age": 35}
{"id": 1, "name": "Alice", "age": 30}
{"id": 2, "name": "Bob", "age": 25}
{"id": 3, "name": "Charlie", "age": 35}
{"id": 1, "name": "Alice", "age": 30}
{"id": 2, "name": "Bob", "age": 25}
{"id": 3, "name": "Charlie", "age": 35}
{"id": 1, "name": "Alice", "age": 30}
Processed a total of 10 messages
Verificando dados no MongoDB...
Dados encontrados no MongoDB:
[
	{
		"_id" : ObjectId("66797693cacd4e392db8ca34"),
		"name" : "Alice",
		"id" : NumberLong(1),
		"age" : NumberLong(30)
	},
	{
		"_id" : ObjectId("66797693cacd4e392db8ca35"),
		"name" : "Bob",
		"id" : NumberLong(2),
		"age" : NumberLong(25)
	},
	{
		"_id" : ObjectId("66797693cacd4e392db8ca36"),
		"name" : "Charlie",
		"id" : NumberLong(3),
		"age" : NumberLong(35)
	},
	{
		"_id" : ObjectId("66797693cacd4e392db8ca37"),
		"name" : "Alice",
		"id" : NumberLong(1),
		"age" : NumberLong(30)
	},
	{
		"_id" : ObjectId("66797693cacd4e392db8ca38"),
		"name" : "Bob",
		"id" : NumberLong(2),
		"age" : NumberLong(25)
	},
	{
		"_id" : ObjectId("66797693cacd4e392db8ca39"),
		"name" : "Charlie",
		"id" : NumberLong(3),
		"age" : NumberLong(35)
	},
	{
		"_id" : ObjectId("667976c9cacd4e392db8ca3a"),
		"name" : "Alice",
		"id" : NumberLong(1),
		"age" : NumberLong(30)
	},
	{
		"_id" : ObjectId("667976c9cacd4e392db8ca3b"),
		"name" : "Bob",
		"id" : NumberLong(2),
		"age" : NumberLong(25)
	},
	{
		"_id" : ObjectId("667976c9cacd4e392db8ca3c"),
		"name" : "Charlie",
		"id" : NumberLong(3),
		"age" : NumberLong(35)
	},
	{
		"_id" : ObjectId("66797705cacd4e392db8ca3d"),
		"name" : "Alice",
		"id" : NumberLong(1),
		"age" : NumberLong(30)
	},
	{
		"_id" : ObjectId("66797705cacd4e392db8ca3e"),
		"name" : "Bob",
		"id" : NumberLong(2),
		"age" : NumberLong(25)
	},
	{
		"_id" : ObjectId("66797705cacd4e392db8ca3f"),
		"name" : "Charlie",
		"id" : NumberLong(3),
		"age" : NumberLong(35)
	},
	{
		"_id" : ObjectId("66797741cacd4e392db8ca40"),
		"name" : "Alice",
		"id" : NumberLong(1),
		"age" : NumberLong(30)
	},
	{
		"_id" : ObjectId("66797741cacd4e392db8ca41"),
		"name" : "Bob",
		"id" : NumberLong(2),
		"age" : NumberLong(25)
	},
	{
		"_id" : ObjectId("66797741cacd4e392db8ca42"),
		"name" : "Charlie",
		"id" : NumberLong(3),
		"age" : NumberLong(35)
	},
	{
		"_id" : ObjectId("6679777ecacd4e392db8ca43"),
		"name" : "Alice",
		"id" : NumberLong(1),
		"age" : NumberLong(30)
	},
	{
		"_id" : ObjectId("6679777ecacd4e392db8ca44"),
		"name" : "Bob",
		"id" : NumberLong(2),
		"age" : NumberLong(25)
	},
	{
		"_id" : ObjectId("6679777ecacd4e392db8ca45"),
		"name" : "Charlie",
		"id" : NumberLong(3),
		"age" : NumberLong(35)
	}
]
Verificando dados no HDFS...
Dados encontrados no HDFS:
Found 3 items
-rw-r--r--   3 appuser supergroup          0 2024-06-24 13:37 /user/appuser/data/topics/+tmp/spark-etl-topic/partition=0/531ca645-019e-4713-b953-92bd10d0e95a_tmp.avro
-rw-r--r--   3 appuser supergroup          0 2024-06-24 13:37 /user/appuser/data/topics/+tmp/spark-etl-topic/partition=0/669dc79e-9822-4604-9dee-94c009d86a5d_tmp.avro
-rw-r--r--   3 appuser supergroup          0 2024-06-24 13:37 /user/appuser/data/topics/+tmp/spark-etl-topic/partition=0/b7303a07-fd04-4961-994a-21eaab443f27_tmp.avro
